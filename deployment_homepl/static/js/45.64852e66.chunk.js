"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[45],{45:(e,t,a)=>{a.r(t),a.d(t,{default:()=>F});var s=a(43),r=a(722);const n="https://timetrackerpro.pl",l=r.A.create({baseURL:n,headers:{"Content-Type":"application/json"}});l.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e))),l.interceptors.response.use((e=>e),(e=>{var t;return 401!==(null===(t=e.response)||void 0===t?void 0:t.status)||window.location.pathname.includes("/panel")||(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/panel"),Promise.reject(e)}));const i=async(e,t)=>{try{return(await l.post("/login.py3",{username:e,password:t})).data}catch(a){throw a}},c=new Map,d=e=>{const t=c.get(e);return t&&Date.now()-t.timestamp<3e5?t.data:null},o=(e,t)=>{c.set(e,{data:t,timestamp:Date.now()})},m=async()=>{const e="companies_all",t=d(e);if(t)return t;const a=await l.get("/companies.py3");return o(e,a.data),a.data},x=async e=>{const t=await l.post("/companies.py3",e);return c.delete("companies_all"),t.data},u=async(e,t)=>{const a=await l.put("/companies.py3?id=".concat(e),t);return c.delete("companies_all"),a.data},p=async e=>{const t=await l.delete("/companies.py3?id=".concat(e));return c.delete("companies_all"),t.data},h=async()=>{const e="users_all",t=d(e);if(t)return t;const a=await l.get("/users.py3");return o(e,a.data),a.data},y=async e=>{const t=await l.post("/users.py3",e);return c.delete("users_all"),t.data},g=async(e,t)=>{const a=await l.put("/users.py3?id=".concat(e),t);return c.delete("users_all"),a.data},j=async e=>{const t=await l.delete("/users.py3?id=".concat(e));return c.delete("users_all"),t.data},b=async()=>{const e="employees_all",t=d(e);if(t)return t;const a=await l.get("/employees.py3");return o(e,a.data),a.data},w=async e=>{const t=await l.post("/employees.py3",e);return c.delete("employees_all"),t.data},f=async(e,t)=>{const a=await l.put("/employees.py3?id=".concat(e),t);return c.delete("employees_all"),a.data},v=async e=>{const t=await l.delete("/employees.py3?id=".concat(e));return c.delete("employees_all"),t.data},N=async e=>(await l.get("/qr_generate.py3?employee_id=".concat(e))).data,k=async(e,t)=>{try{console.log("Downloading PDF for employee:",t,"ID:",e),console.log("API URL:",n);const a=await l.get("/qr_generate.py3?employee_id=".concat(e,"&format=pdf"),{responseType:"blob"});console.log("Response received:",a.status);const s=new Blob([a.data],{type:"application/pdf"}),r=window.URL.createObjectURL(s),i=document.createElement("a");i.href=r;const c=t.replace(/[^a-zA-Z0-9]/g,"_");return i.download="qr_code_".concat(c,".pdf"),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(r),console.log("PDF download completed successfully"),a.data}catch(a){throw console.error("Error downloading PDF:",a),a}},z=async()=>{const e="time_entries_all",t=d(e);if(t)return t;const a=await l.get("/time_entries.py3");return o(e,a.data),a.data},_=async e=>{const t=await l.post("/time_entries.py3",e);return c.delete("time_entries_all"),t.data},S=async(e,t)=>{const a=await l.put("/time_entries.py3?id=".concat(e),t);return c.delete("time_entries_all"),a.data},C=async e=>{const t=await l.delete("/time_entries.py3?id=".concat(e));return c.delete("time_entries_all"),t.data},D=async(e,t)=>{const a="employee_summary_".concat(e,"_").concat(t),s=d(a);if(s)return s;const r=new URLSearchParams;e&&r.append("month",e),t&&r.append("year",t);const n=await l.get("/employee_summary.py3?".concat(r));return o(a,n.data),n.data},A=async e=>{const t="employee_months_".concat(e),a=d(t);if(a)return a;const s=await l.get("/employee_months.py3?employee_id=".concat(e));return o(t,s.data),s.data},L=async(e,t)=>{const a="employee_days_".concat(e,"_").concat(t),s=d(a);if(s)return s;const r=await l.get("/employee_days.py3?employee_id=".concat(e,"&year_month=").concat(t));return o(a,r.data),r.data},R=async(e,t)=>{const a=await l.post("/qr_scan.py3",{qr_code:e,user_id:t});return c.delete("time_entries_all"),a.data};var P=a(579);const E=function(e){let{onLogin:t}=e;const[a,r]=(0,s.useState)(""),[n,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(!1),[o,m]=(0,s.useState)("");return(0,P.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center px-4",children:[(0,P.jsx)("div",{className:"absolute top-4 left-4 z-10",children:(0,P.jsxs)("button",{onClick:()=>window.location.href="/",className:"flex items-center space-x-2 bg-white/10 backdrop-blur-sm text-white px-4 py-2 rounded-lg hover:bg-white/20 transition-all transform hover:scale-105",children:[(0,P.jsx)("div",{className:"w-8 h-8 bg-white rounded-lg flex items-center justify-center",children:(0,P.jsx)("svg",{className:"w-5 h-5 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})})}),(0,P.jsx)("span",{className:"font-bold text-lg",children:"TimeTrackerPro"})]})}),(0,P.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 w-full max-w-md",children:[(0,P.jsxs)("div",{className:"text-center mb-8",children:[(0,P.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"System Ewidencji"}),(0,P.jsx)("p",{className:"text-gray-600",children:"Czasu Pracy"})]}),o&&(0,P.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:o}),(0,P.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),d(!0),m("");try{const e=await i(a,n);e.access_token&&e.user?t(e.user,e.access_token):m("B\u0142\u0119dne dane logowania")}catch(o){console.error("Login error:",o),m("B\u0142\u0119dne dane logowania")}d(!1)},className:"space-y-6",children:[(0,P.jsxs)("div",{children:[(0,P.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nazwa u\u017cytkownika"}),(0,P.jsx)("input",{type:"text",id:"username",value:a,onChange:e=>r(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,P.jsxs)("div",{children:[(0,P.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Has\u0142o"}),(0,P.jsx)("input",{type:"password",id:"password",value:n,onChange:e=>l(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),(0,P.jsx)("button",{type:"submit",disabled:c,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition duration-200",children:c?"Logowanie...":"Zaloguj si\u0119"})]})]})]})};var B=a(544);const I=function(e){let{onScan:t,loading:a,disabled:r}=e;const[n,l]=(0,s.useState)(!1),[i,c]=(0,s.useState)(null),[d,o]=(0,s.useState)("environment"),[m,x]=(0,s.useState)(!1),[u,p]=(0,s.useState)(0),[h,y]=(0,s.useState)(null),[g,j]=(0,s.useState)(0),[b,w]=(0,s.useState)(!0),f=(0,s.useRef)(null),v=(0,s.useRef)(null),N=(0,s.useRef)(null),k=(0,s.useRef)(!1),z=(0,s.useRef)(null);(0,s.useEffect)((()=>(b&&!r&&_(),()=>{S(),N.current&&clearInterval(N.current)})),[]),(0,s.useEffect)((()=>{k.current=m}),[m]),(0,s.useEffect)((()=>{z.current=h}),[h]);const _=async()=>{try{c(null),l(!0),v.current&&v.current.destroy();const e=new B.A(f.current,(e=>{if(e&&e.data){const s=Date.now();if(console.log("QR Code detected:",e.data),s-g<1e3)return void console.log("Too rapid scanning, ignoring...");if(z.current===e.data&&k.current)return void console.log("Same code detected during cooldown, ignoring...");if(k.current||a)return void console.log("Processing in progress, ignoring scan...");j(s),y(e.data),z.current=e.data,t(e.data),v.current&&v.current.stop(),p(5),x(!0),k.current=!0,N.current&&clearInterval(N.current),N.current=setInterval((()=>{p((e=>e<=1?(clearInterval(N.current),x(!1),k.current=!1,y(null),z.current=null,b&&!r&&setTimeout((()=>{_()}),100),0):e-1))}),1e3)}}),{onDecodeError:e=>{},preferredCamera:d,highlightScanRegion:!0,highlightCodeOutline:!0,returnDetailedScanResult:!0,maxScansPerSecond:2});v.current=e,await e.start()}catch(e){console.error("Error starting QR scanner:",e),c("Nie mo\u017cna uzyska\u0107 dost\u0119pu do kamery. Sprawd\u017a uprawnienia."),l(!1)}},S=()=>{v.current&&(v.current.destroy(),v.current=null),l(!1),N.current&&(clearInterval(N.current),p(0),x(!1),k.current=!1),y(null),z.current=null};return(0,s.useEffect)((()=>{n&&!m&&d&&_()}),[d]),(0,P.jsxs)("div",{className:"qr-scanner-container",children:[i&&(0,P.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:[i,(0,P.jsx)("button",{onClick:()=>c(null),className:"ml-2 text-red-800 hover:text-red-900",children:"\u2715"})]}),u>0&&(0,P.jsx)("div",{className:"bg-orange-100 border border-orange-400 text-orange-700 px-4 py-3 rounded mb-4",children:(0,P.jsxs)("div",{className:"flex items-center",children:[(0,P.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),(0,P.jsxs)("span",{className:"font-medium",children:["Kod zosta\u0142 zeskanowany! Automatyczne ponowne uruchomienie za ",u," sekund"]})]})}),(0,P.jsxs)("div",{className:"relative",children:[(0,P.jsx)("video",{ref:f,className:"qr-scanner-video w-full h-64 object-cover rounded-lg",style:{display:n||m?"block":"none"}}),!n&&!m&&(0,P.jsx)("div",{className:"w-full h-64 bg-gray-200 rounded-lg flex items-center justify-center",children:(0,P.jsxs)("div",{className:"text-center",children:[(0,P.jsx)("svg",{className:"w-16 h-16 mx-auto text-gray-400 mb-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),(0,P.jsx)("p",{className:"text-gray-500",children:"Kamera nie jest aktywna"})]})}),(a||m)&&(0,P.jsx)("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center rounded-lg",children:(0,P.jsxs)("div",{className:"text-center text-white",children:[(0,P.jsx)("div",{className:"spinner border-4 border-gray-300 border-t-blue-500 rounded-full w-8 h-8 animate-spin mx-auto mb-2"}),(0,P.jsx)("p",{className:"text-sm font-medium",children:m?"Automatyczne uruchomienie za ".concat(u,"s"):"Przetwarzanie..."})]})}),(n||m)&&!a&&(0,P.jsxs)("div",{className:"absolute inset-0 pointer-events-none",children:[(0,P.jsx)("div",{className:"absolute top-4 left-4 w-8 h-8 border-t-2 border-l-2 border-green-500"}),(0,P.jsx)("div",{className:"absolute top-4 right-4 w-8 h-8 border-t-2 border-r-2 border-green-500"}),(0,P.jsx)("div",{className:"absolute bottom-4 left-4 w-8 h-8 border-b-2 border-l-2 border-green-500"}),(0,P.jsx)("div",{className:"absolute bottom-4 right-4 w-8 h-8 border-b-2 border-r-2 border-green-500"}),(0,P.jsx)("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:(0,P.jsx)("div",{className:"w-6 h-6 border-2 border-green-500 bg-green-500/20 rounded"})})]})]}),(0,P.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,P.jsx)("button",{onClick:()=>{m||(n?(S(),w(!1)):(w(!0),_()))},disabled:r||m,className:"flex-1 px-4 py-2 rounded-md font-medium transition-colors ".concat(n?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"," disabled:opacity-50 disabled:cursor-not-allowed"),children:m?"Automatyczne uruchomienie za ".concat(u,"s"):n?"Zatrzymaj":"Uruchom skaner"}),n&&(0,P.jsx)("button",{onClick:async()=>{if(m)return void c("Nie mo\u017cna prze\u0142\u0105czy\u0107 kamery podczas przetwarzania");const e="environment"===d?"user":"environment";if(o(e),v.current)try{await v.current.setCamera(e)}catch(t){console.error("Error switching camera:",t),c("Nie mo\u017cna prze\u0142\u0105czy\u0107 kamery")}},disabled:r||m,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed",title:"Prze\u0142\u0105cz kamer\u0119",children:"\ud83d\udcf7"})]}),(0,P.jsxs)("div",{className:"mt-2 text-sm text-gray-600",children:[(0,P.jsxs)("p",{children:["\u2022 Kamera: ","environment"===d?"Tylna":"Przednia"]}),(0,P.jsx)("p",{children:"\u2022 Skaner automatycznie uruchamia si\u0119 po za\u0142adowaniu"}),(0,P.jsx)("p",{children:"\u2022 Automatyczne ponowne uruchomienie po 5 sekundach"}),(0,P.jsx)("p",{children:"\u2022 \u26a1 Ulepszona stabilno\u015b\u0107 - brak bug\xf3w podczas skanowania"}),m&&(0,P.jsxs)("p",{className:"text-orange-600 font-medium",children:["\u2022 \u23f3 Odliczanie: ",u," sekund do ponownego uruchomienia"]}),!n&&!m&&(0,P.jsxs)("p",{className:"text-blue-600 font-medium",children:["\u2022 \ud83d\udd04 Automatyczne uruchamianie: ",b?"W\u0142\u0105czone":"Wy\u0142\u0105czone"]})]})]})};const U=function(e){let{user:t,onLogout:a}=e;const[r,n]=(0,s.useState)(null),[l,i]=(0,s.useState)(!1),[c,d]=(0,s.useState)(null);(0,s.useEffect)((()=>{o()}),[]);const o=async()=>{try{t.company_id&&t.company_name&&d({id:t.company_id,name:t.company_name})}catch(e){console.error("B\u0142\u0105d pobierania informacji o firmie:",e)}};return(0,P.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,P.jsx)("div",{className:"bg-white shadow-sm",children:(0,P.jsx)("div",{className:"max-w-md mx-auto px-4 py-4",children:(0,P.jsxs)("div",{className:"flex justify-between items-center",children:[(0,P.jsxs)("div",{children:[(0,P.jsx)("h1",{className:"text-xl font-semibold text-gray-800",children:"Skaner QR"}),(0,P.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,P.jsxs)("p",{children:["Witaj, ",t.username]}),c&&(0,P.jsx)("p",{children:(0,P.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["\ud83c\udfe2 ",c.name]})})]})]}),(0,P.jsx)("button",{onClick:a,className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Wyloguj"})]})})}),(0,P.jsxs)("div",{className:"max-w-md mx-auto px-4 py-6",children:[c&&(0,P.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[(0,P.jsx)("h2",{className:"text-lg font-semibold text-green-800 mb-2",children:"\ud83d\udd12 Zabezpieczenie Firmy"}),(0,P.jsxs)("ul",{className:"text-sm text-green-700 space-y-1",children:[(0,P.jsx)("li",{children:"\u2022 Mo\u017cesz skanowa\u0107 tylko kody QR z Twojej firmy"}),(0,P.jsx)("li",{children:"\u2022 Dane firm s\u0105 ca\u0142kowicie oddzielone"}),(0,P.jsxs)("li",{children:["\u2022 Twoja firma: ",(0,P.jsx)("strong",{children:c.name})]})]})]}),(0,P.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,P.jsx)("h2",{className:"text-lg font-semibold text-blue-800 mb-2",children:"Instrukcja u\u017cycia"}),(0,P.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,P.jsx)("li",{children:"\u2022 Skaner uruchamia si\u0119 automatycznie po za\u0142adowaniu strony"}),(0,P.jsx)("li",{children:"\u2022 Zeskanuj kod QR pracownika z Twojej firmy"}),(0,P.jsx)("li",{children:"\u2022 Pierwsze skanowanie = rozpocz\u0119cie pracy"}),(0,P.jsx)("li",{children:"\u2022 Drugie skanowanie = zako\u0144czenie pracy"}),(0,P.jsx)("li",{children:"\u2022 \ud83d\udee1\ufe0f Automatyczne zatrzymanie po wykryciu kodu"}),(0,P.jsx)("li",{children:"\u2022 \u23f0 Automatyczne ponowne uruchomienie po 5 sekundach"}),(0,P.jsx)("li",{children:"\u2022 \ud83d\udd04 Mo\u017cliwo\u015b\u0107 prze\u0142\u0105czania kamery prz\xf3d/ty\u0142"}),(0,P.jsx)("li",{children:"\u2022 \ud83c\udfaf Nie musisz klika\u0107 przycisk\xf3w - wszystko dzia\u0142a automatycznie!"})]})]}),(0,P.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[(0,P.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Skanuj kod QR"}),(0,P.jsx)(I,{onScan:async e=>{i(!0),n(null);try{const a=await R(e,t.id);a.success?n({success:!0,action:a.action,employee:a.employee_name,time:a.time,message:a.message,cooldown_seconds:a.cooldown_seconds}):n({success:!1,message:a.message,isUnauthorized:!0})}catch(a){console.error("Error processing QR scan:",a),n({success:!1,message:"B\u0142\u0105d po\u0142\u0105czenia z serwerem"})}i(!1)},loading:l,disabled:l})]}),r&&(0,P.jsx)("div",{className:"rounded-lg p-4 mb-6 ".concat(r.success?"bg-green-50 border border-green-200":r.isCooldown?"bg-orange-50 border border-orange-200":(r.isUnauthorized,"bg-red-50 border border-red-200")),children:(0,P.jsxs)("div",{className:"flex justify-between items-start",children:[(0,P.jsx)("div",{className:"flex-1",children:r.success?(0,P.jsxs)("div",{children:[(0,P.jsxs)("div",{className:"flex items-center mb-2",children:[(0,P.jsx)("svg",{className:"w-5 h-5 text-green-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),(0,P.jsx)("h3",{className:"text-lg font-semibold text-green-800",children:"check_in"===r.action?"Rozpocz\u0119to prac\u0119":"Zako\u0144czono prac\u0119"})]}),(0,P.jsxs)("div",{className:"text-green-700 space-y-1",children:[(0,P.jsxs)("p",{children:[(0,P.jsx)("strong",{children:"Pracownik:"})," ",r.employee]}),(0,P.jsxs)("p",{children:[(0,P.jsx)("strong",{children:"Czas:"})," ",r.time]}),(0,P.jsx)("p",{className:"text-sm",children:r.message})]})]}):r.isUnauthorized?(0,P.jsxs)("div",{children:[(0,P.jsxs)("div",{className:"flex items-center mb-2",children:[(0,P.jsx)("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,P.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"Brak dost\u0119pu"})]}),(0,P.jsx)("p",{className:"text-red-700",children:r.message}),(0,P.jsx)("p",{className:"text-sm text-red-600 mt-1",children:"Mo\u017cesz skanowa\u0107 tylko kody QR pracownik\xf3w z Twojej firmy."})]}):(0,P.jsxs)("div",{children:[(0,P.jsxs)("div",{className:"flex items-center mb-2",children:[(0,P.jsx)("svg",{className:"w-5 h-5 text-red-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),(0,P.jsx)("h3",{className:"text-lg font-semibold text-red-800",children:"B\u0142\u0105d"})]}),(0,P.jsx)("p",{className:"text-red-700",children:r.message})]})}),(0,P.jsx)("button",{onClick:()=>{n(null)},className:"ml-4 text-gray-400 hover:text-gray-600",children:(0,P.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,P.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}),(0,P.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[(0,P.jsx)("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Pomoc"}),(0,P.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,P.jsx)("p",{children:"\u2022 Upewnij si\u0119, \u017ce kamera ma dost\u0119p do urz\u0105dzenia"}),(0,P.jsx)("p",{children:"\u2022 Trzymaj kod QR w centrum kamery"}),(0,P.jsx)("p",{children:"\u2022 Poczekaj na automatyczne rozpoznanie"}),(0,P.jsx)("p",{children:"\u2022 Kod QR musi nale\u017ce\u0107 do Twojej firmy"})]})]})]})]})};var q=a(555);const Q=function(e){let{user:t,onLogout:a}=e;const[r,n]=(0,s.useState)("employees"),[l,i]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),[o,m]=(0,s.useState)(null),[x,u]=(0,s.useState)(!0),[p,h]=(0,s.useState)(""),[y,g]=(0,s.useState)([]),[j,R]=(0,s.useState)(null),[E,B]=(0,s.useState)([]),[I,U]=(0,s.useState)(null),[Q,T]=(0,s.useState)([]),[F,W]=(0,s.useState)("main"),[M,Z]=(0,s.useState)(!1),[O,K]=(0,s.useState)(null),[H,V]=(0,s.useState)(null),[G,J]=(0,s.useState)(!1),[X,Y]=(0,s.useState)(null),[$,ee]=(0,s.useState)({name:"",is_active:!0}),[te,ae]=(0,s.useState)(!1),[se,re]=(0,s.useState)(null),[ne,le]=(0,s.useState)({employee_id:"",check_in:"",check_out:""});(0,s.useEffect)((()=>{ie()}),[]);const ie=async()=>{try{u(!0),h(""),t.company_id&&t.company_name&&m({id:t.company_id,name:t.company_name});const[e,a]=await Promise.all([b(),z()]);i(e),d(a)}catch(p){console.error("Error loading data:",p),h("B\u0142\u0105d podczas \u0142adowania danych")}finally{u(!1)}},ce=e=>{const t=l.find((t=>t.id===e));return t?t.name:"Nieznany"};return x?(0,P.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,P.jsx)("div",{className:"text-xl",children:"\u0141adowanie..."})}):(0,P.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,P.jsx)("div",{className:"bg-white shadow-sm",children:(0,P.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,P.jsxs)("div",{className:"flex justify-between items-center",children:[(0,P.jsxs)("div",{children:[(0,P.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Panel Administratora"}),(0,P.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,P.jsxs)("p",{children:["Witaj, ",t.username]}),o&&(0,P.jsx)("p",{children:(0,P.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["\ud83c\udfe2 ",o.name]})})]})]}),(0,P.jsx)("button",{onClick:a,className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Wyloguj"})]})})}),p&&(0,P.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,P.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:p})}),(0,P.jsx)("div",{className:"bg-white border-b",children:(0,P.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,P.jsxs)("nav",{className:"flex space-x-8",children:[(0,P.jsx)("button",{onClick:()=>n("employees"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("employees"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Pracownicy"}),(0,P.jsx)("button",{onClick:()=>n("reports"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("reports"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Raporty czasu"}),(0,P.jsx)("button",{onClick:()=>{n("summary"),"summary"!==r&&(W("main"),(async(e,t)=>{try{u(!0),h("");const a=await D(e,t);g(a)}catch(p){console.error("Error loading employee summary:",p),h("B\u0142\u0105d podczas \u0142adowania podsumowania pracownik\xf3w")}finally{u(!1)}})())},className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("summary"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Podsumowanie pracownik\xf3w"})]})})}),(0,P.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:["employees"===r&&(0,P.jsx)("div",{children:(0,P.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,P.jsxs)("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[(0,P.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Lista pracownik\xf3w"}),(0,P.jsx)("button",{onClick:()=>{Y(null),ee({name:"",is_active:!0}),J(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Dodaj pracownika"})]}),(0,P.jsx)("div",{className:"overflow-x-auto",children:(0,P.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,P.jsx)("thead",{className:"bg-gray-50",children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Imi\u0119 i nazwisko"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kod QR"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Akcje"})]})}),(0,P.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((e=>(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm text-gray-500",children:e.qr_code})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.is_active?"Aktywny":"Nieaktywny"})}),(0,P.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,P.jsx)("button",{onClick:()=>(e=>{Y(e),ee({name:e.name,is_active:e.is_active}),J(!0)})(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edytuj"}),(0,P.jsx)("button",{onClick:()=>(async e=>{try{h("");const t=await N(e.id);K(e),V(t),Z(!0)}catch(p){console.error("Error generating QR code:",p),h("B\u0142\u0105d podczas generowania kodu QR")}})(e),className:"text-green-600 hover:text-green-900 mr-4",children:"Generuj QR"}),(0,P.jsx)("button",{onClick:()=>(async e=>{try{h(""),await k(e.id,e.name)}catch(p){console.error("Error downloading QR PDF:",p),h("B\u0142\u0105d podczas pobierania PDF z kodem QR")}})(e),className:"text-purple-600 hover:text-purple-900 mr-4",children:"Pobierz PDF"}),(0,P.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Czy na pewno chcesz usun\u0105\u0107 tego pracownika?"))try{await v(e),await ie()}catch(p){console.error("Error deleting employee:",p),h("B\u0142\u0105d podczas usuwania pracownika")}})(e.id),className:"text-red-600 hover:text-red-900",children:"Usu\u0144"})]})]},e.id)))})]})})]})}),"reports"===r&&(0,P.jsx)("div",{children:(0,P.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,P.jsxs)("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[(0,P.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Raporty czasu pracy"}),(0,P.jsx)("button",{onClick:()=>{re(null),le({employee_id:"",check_in:"",check_out:""}),ae(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Dodaj wpis"})]}),(0,P.jsx)("div",{className:"overflow-x-auto",children:(0,P.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,P.jsx)("thead",{className:"bg-gray-50",children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Imi\u0119 i nazwisko"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Przyj\u015bcie"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Wyj\u015bcie"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Godziny pracy"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Akcje"})]})}),(0,P.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map((e=>(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm font-medium text-gray-900",children:ce(e.employee_id)})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.date).toLocaleDateString("pl-PL")}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.check_in).toLocaleTimeString("pl-PL",{hour:"2-digit",minute:"2-digit"})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.check_out?new Date(e.check_out).toLocaleTimeString("pl-PL",{hour:"2-digit",minute:"2-digit"}):"-"}),(0,P.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.total_hours||0,"h"]}),(0,P.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,P.jsx)("button",{onClick:()=>{return re(t=e),le({employee_id:t.employee_id,check_in:t.check_in?new Date(t.check_in).toISOString().slice(0,16):"",check_out:t.check_out?new Date(t.check_out).toISOString().slice(0,16):""}),void ae(!0);var t},className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edytuj"}),(0,P.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Czy na pewno chcesz usun\u0105\u0107 ten wpis czasu?"))try{await C(e),await ie()}catch(p){console.error("Error deleting time entry:",p),h("B\u0142\u0105d podczas usuwania wpisu czasu")}})(e.id),className:"text-red-600 hover:text-red-900",children:"Usu\u0144"})]})]},e.id)))})]})})]})}),"summary"===r&&(0,P.jsxs)("div",{children:["main"===F&&(0,P.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,P.jsxs)("div",{className:"px-6 py-4 border-b",children:[(0,P.jsxs)("h2",{className:"text-lg font-semibold text-gray-800",children:["Podsumowanie pracownik\xf3w - ",(new Date).toLocaleDateString("pl-PL",{month:"long",year:"numeric"})]}),(0,P.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Kliknij na pracownika, aby zobaczy\u0107 szczeg\xf3\u0142y miesi\u0119cy"})]}),(0,P.jsxs)("div",{className:"overflow-x-auto",children:[(0,P.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,P.jsx)("thead",{className:"bg-gray-50",children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Imi\u0119 i nazwisko"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Liczba godzin w miesi\u0105cu"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Akcje"})]})}),(0,P.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:y.map((e=>(0,P.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.employee_name})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsxs)("div",{className:"text-sm text-gray-900 font-semibold",children:[e.total_hours.toFixed(1),"h"]})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,P.jsx)("button",{onClick:()=>(async e=>{try{R(e),u(!0),h("");const t=await A(e.employee_id);B(t),W("months")}catch(p){console.error("Error loading employee months:",p),h("B\u0142\u0105d podczas \u0142adowania miesi\u0119cy pracownika")}finally{u(!1)}})(e),className:"text-blue-600 hover:text-blue-900",children:"Zobacz miesi\u0105ce"})})]},e.employee_id)))})]}),0===y.length&&(0,P.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Brak danych o pracownikach"})]})]}),"months"===F&&j&&(0,P.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,P.jsx)("div",{className:"px-6 py-4 border-b",children:(0,P.jsxs)("div",{className:"flex items-center justify-between",children:[(0,P.jsxs)("div",{children:[(0,P.jsxs)("h2",{className:"text-lg font-semibold text-gray-800",children:["Miesi\u0105ce pracy - ",j.employee_name]}),(0,P.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Kliknij na miesi\u0105c, aby zobaczy\u0107 szczeg\xf3\u0142y dni"})]}),(0,P.jsx)("button",{onClick:()=>{W("main"),R(null),B([]),U(null),T([])},className:"text-blue-600 hover:text-blue-900 text-sm font-medium",children:"\u2190 Powr\xf3t do podsumowania"})]})}),(0,P.jsxs)("div",{className:"overflow-x-auto",children:[(0,P.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,P.jsx)("thead",{className:"bg-gray-50",children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Miesi\u0105c"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Liczba godzin"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Dni pracy"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Akcje"})]})}),(0,P.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map((e=>(0,P.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm font-medium text-gray-900",children:new Date(e.month+"-01").toLocaleDateString("pl-PL",{month:"long",year:"numeric"})})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsxs)("div",{className:"text-sm text-gray-900 font-semibold",children:[e.total_hours.toFixed(1),"h"]})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsxs)("div",{className:"text-sm text-gray-900",children:[e.days_worked," dni"]})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,P.jsx)("button",{onClick:()=>(async e=>{try{U(e),u(!0),h("");const t=await L(j.employee_id,e.month);T(t),W("days")}catch(p){console.error("Error loading employee days:",p),h("B\u0142\u0105d podczas \u0142adowania dni pracownika")}finally{u(!1)}})(e),className:"text-blue-600 hover:text-blue-900",children:"Zobacz dni"})})]},e.month)))})]}),0===E.length&&(0,P.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Brak danych o miesi\u0105cach pracy"})]})]}),"days"===F&&j&&I&&(0,P.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,P.jsx)("div",{className:"px-6 py-4 border-b",children:(0,P.jsxs)("div",{className:"flex items-center justify-between",children:[(0,P.jsxs)("div",{children:[(0,P.jsxs)("h2",{className:"text-lg font-semibold text-gray-800",children:["Dni pracy - ",j.employee_name]}),(0,P.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:new Date(I.month+"-01").toLocaleDateString("pl-PL",{month:"long",year:"numeric"})})]}),(0,P.jsx)("button",{onClick:()=>{W("months"),U(null),T([])},className:"text-blue-600 hover:text-blue-900 text-sm font-medium",children:"\u2190 Powr\xf3t do miesi\u0119cy"})]})}),(0,P.jsxs)("div",{className:"overflow-x-auto",children:[(0,P.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,P.jsx)("thead",{className:"bg-gray-50",children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Przyj\u015bcie"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Wyj\u015bcie"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Godziny pracy"})]})}),(0,P.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:Q.map((e=>(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm font-medium text-gray-900",children:new Date(e.date).toLocaleDateString("pl-PL",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm text-gray-900",children:e.check_in||"-"})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm text-gray-900",children:e.check_out||"-"})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm text-gray-900 font-semibold",children:e.total_hours?e.total_hours.toFixed(1)+"h":"-"})})]},e.date)))})]}),0===Q.length&&(0,P.jsx)("div",{className:"text-center py-8 text-gray-500",children:"Brak danych o dniach pracy"})]})]})]})]}),M&&O&&H&&(0,P.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,P.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,P.jsxs)("div",{className:"mt-3 text-center",children:[(0,P.jsxs)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:["Kod QR dla ",O.name]}),(0,P.jsx)("div",{className:"mb-4",children:(0,P.jsx)("img",{src:"data:image/png;base64,".concat(H.qr_code_image),alt:"QR Code",className:"mx-auto border rounded-lg"})}),(0,P.jsx)("div",{className:"text-sm text-gray-600 mb-4",children:(0,P.jsxs)("p",{children:["Kod: ",(0,P.jsx)("span",{className:"font-mono font-bold",children:H.qr_code_data})]})}),(0,P.jsx)("div",{className:"flex justify-center",children:(0,P.jsx)("button",{onClick:()=>Z(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Zamknij"})})]})})}),te&&(0,P.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,P.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,P.jsxs)("div",{className:"mt-3",children:[(0,P.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:se?"Edytuj wpis czasu - ".concat(ce(se.employee_id)):"Dodaj nowy wpis czasu"}),(0,P.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e={employee_id:ne.employee_id,check_in:ne.check_in?new Date(ne.check_in).toISOString():null,check_out:ne.check_out?new Date(ne.check_out).toISOString():null};se?await S(se.id,e):await _(e),ae(!1),await ie()}catch(p){console.error("Error saving time entry:",p),h("B\u0142\u0105d podczas zapisywania wpisu czasu")}},children:[!se&&(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pracownik"}),(0,P.jsxs)("select",{value:ne.employee_id,onChange:e=>le((0,q.A)((0,q.A)({},ne),{},{employee_id:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,P.jsx)("option",{value:"",children:"Wybierz pracownika"}),l.map((e=>(0,P.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),se&&(0,P.jsx)("div",{className:"mb-4",children:(0,P.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Data: ",new Date(se.date).toLocaleDateString("pl-PL")]})}),(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Przyj\u015bcie"}),(0,P.jsx)("input",{type:"datetime-local",value:ne.check_in,onChange:e=>le((0,q.A)((0,q.A)({},ne),{},{check_in:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Wyj\u015bcie"}),(0,P.jsx)("input",{type:"datetime-local",value:ne.check_out,onChange:e=>le((0,q.A)((0,q.A)({},ne),{},{check_out:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(0,P.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,P.jsx)("button",{type:"button",onClick:()=>ae(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Anuluj"}),(0,P.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:se?"Zaktualizuj":"Dodaj"})]})]})]})})}),G&&(0,P.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,P.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,P.jsxs)("div",{className:"mt-3",children:[(0,P.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:X?"Edytuj pracownika":"Dodaj pracownika"}),(0,P.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=(0,q.A)((0,q.A)({},$),{},{company_id:t.company_id});X?await f(X.id,e):await w(e),J(!1),await ie()}catch(p){console.error("Error saving employee:",p),h("B\u0142\u0105d podczas zapisywania pracownika")}},children:[(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imi\u0119 i nazwisko"}),(0,P.jsx)("input",{type:"text",value:$.name,onChange:e=>ee((0,q.A)((0,q.A)({},$),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,P.jsxs)("select",{value:$.is_active,onChange:e=>ee((0,q.A)((0,q.A)({},$),{},{is_active:"true"===e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,P.jsx)("option",{value:"true",children:"Aktywny"}),(0,P.jsx)("option",{value:"false",children:"Nieaktywny"})]})]}),(0,P.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,P.jsx)("button",{type:"button",onClick:()=>J(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Anuluj"}),(0,P.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:X?"Zaktualizuj":"Dodaj"})]})]})]})})})]})};const T=function(e){let{user:t,onLogout:a}=e;const[r,n]=(0,s.useState)("companies"),[l,i]=(0,s.useState)([]),[c,d]=(0,s.useState)([]),[o,b]=(0,s.useState)({}),[w,f]=(0,s.useState)(!0),[v,N]=(0,s.useState)(""),[k,z]=(0,s.useState)(!1),[_,S]=(0,s.useState)(null),[C,D]=(0,s.useState)({name:""}),[A,L]=(0,s.useState)(!1),[R,E]=(0,s.useState)(null),[B,I]=(0,s.useState)({username:"",password:"",type:"user",company_id:""});(0,s.useEffect)((()=>{U()}),[]);const U=async()=>{try{f(!0),N("");const[e,t]=await Promise.all([m(),h()]);i(e),d(t),b({totalCompanies:e.length,totalUsers:t.length,totalEmployees:0,totalTimeEntries:0})}catch(v){console.error("Error loading data:",v),N("B\u0142\u0105d podczas \u0142adowania danych")}finally{f(!1)}};return w?(0,P.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,P.jsx)("div",{className:"text-xl",children:"\u0141adowanie..."})}):(0,P.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,P.jsx)("div",{className:"bg-white shadow-sm",children:(0,P.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,P.jsxs)("div",{className:"flex justify-between items-center",children:[(0,P.jsxs)("div",{children:[(0,P.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Panel W\u0142a\u015bciciela"}),(0,P.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,P.jsxs)("p",{children:["Witaj, ",t.username]}),(0,P.jsx)("p",{children:(0,P.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:"\ud83d\udc51 System Owner"})})]})]}),(0,P.jsx)("button",{onClick:a,className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Wyloguj"})]})})}),v&&(0,P.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4",children:(0,P.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:v})}),(0,P.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[(0,P.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[(0,P.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,P.jsxs)("div",{className:"flex items-center",children:[(0,P.jsx)("div",{className:"text-3xl",children:"\ud83c\udfe2"}),(0,P.jsxs)("div",{className:"ml-4",children:[(0,P.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Firmy"}),(0,P.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:o.totalCompanies})]})]})}),(0,P.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,P.jsxs)("div",{className:"flex items-center",children:[(0,P.jsx)("div",{className:"text-3xl",children:"\ud83d\udc65"}),(0,P.jsxs)("div",{className:"ml-4",children:[(0,P.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Pracownicy"}),(0,P.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:o.totalEmployees})]})]})}),(0,P.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,P.jsxs)("div",{className:"flex items-center",children:[(0,P.jsx)("div",{className:"text-3xl",children:"\ud83d\udd11"}),(0,P.jsxs)("div",{className:"ml-4",children:[(0,P.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"U\u017cytkownicy"}),(0,P.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:o.totalUsers})]})]})}),(0,P.jsx)("div",{className:"bg-white rounded-lg shadow p-6",children:(0,P.jsxs)("div",{className:"flex items-center",children:[(0,P.jsx)("div",{className:"text-3xl",children:"\u23f0"}),(0,P.jsxs)("div",{className:"ml-4",children:[(0,P.jsx)("p",{className:"text-sm font-medium text-gray-600",children:"Wpisy czasu"}),(0,P.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:o.totalTimeEntries})]})]})})]}),(0,P.jsx)("div",{className:"bg-white border-b rounded-t-lg",children:(0,P.jsx)("div",{className:"px-6",children:(0,P.jsxs)("nav",{className:"flex space-x-8",children:[(0,P.jsx)("button",{onClick:()=>n("companies"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("companies"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"Firmy"}),(0,P.jsx)("button",{onClick:()=>n("users"),className:"py-4 px-1 border-b-2 font-medium text-sm ".concat("users"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:"U\u017cytkownicy"})]})})}),(0,P.jsxs)("div",{className:"bg-white rounded-b-lg shadow",children:["companies"===r&&(0,P.jsxs)("div",{children:[(0,P.jsxs)("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[(0,P.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Lista firm"}),(0,P.jsx)("button",{onClick:()=>{S(null),D({name:""}),z(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Dodaj firm\u0119"})]}),(0,P.jsx)("div",{className:"overflow-x-auto",children:(0,P.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,P.jsx)("thead",{className:"bg-gray-50",children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nazwa firmy"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data utworzenia"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Akcje"})]})}),(0,P.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map((e=>(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString("pl-PL")}),(0,P.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,P.jsx)("button",{onClick:()=>(e=>{S(e),D({name:e.name}),z(!0)})(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edytuj"}),(0,P.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Czy na pewno chcesz usun\u0105\u0107 t\u0119 firm\u0119?"))try{await p(e),await U()}catch(v){console.error("Error deleting company:",v),N("B\u0142\u0105d podczas usuwania firmy")}})(e.id),className:"text-red-600 hover:text-red-900",children:"Usu\u0144"})]})]},e.id)))})]})})]}),"users"===r&&(0,P.jsxs)("div",{children:[(0,P.jsxs)("div",{className:"px-6 py-4 border-b flex justify-between items-center",children:[(0,P.jsx)("h2",{className:"text-lg font-semibold text-gray-800",children:"Lista u\u017cytkownik\xf3w"}),(0,P.jsx)("button",{onClick:()=>{E(null),I({username:"",password:"",type:"user",company_id:""}),L(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors",children:"Dodaj u\u017cytkownika"})]}),(0,P.jsx)("div",{className:"overflow-x-auto",children:(0,P.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,P.jsx)("thead",{className:"bg-gray-50",children:(0,P.jsxs)("tr",{children:[(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"U\u017cytkownik"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rola"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Firma"}),(0,P.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Akcje"})]})}),(0,P.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map((e=>(0,P.jsxs)("tr",{children:[(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.username})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,P.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("owner"===e.role?"bg-purple-100 text-purple-800":"admin"===e.role?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"),children:"owner"===e.role?"W\u0142a\u015bciciel":"admin"===e.role?"Administrator":"U\u017cytkownik"})}),(0,P.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.company_name||"Brak"}),(0,P.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[(0,P.jsx)("button",{onClick:()=>(e=>{E(e),I({username:e.username,password:"",type:e.type,company_id:e.company_id||""}),L(!0)})(e),className:"text-blue-600 hover:text-blue-900 mr-4",children:"Edytuj"}),(0,P.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Czy na pewno chcesz usun\u0105\u0107 tego u\u017cytkownika?"))try{await j(e),await U()}catch(v){console.error("Error deleting user:",v),N("B\u0142\u0105d podczas usuwania u\u017cytkownika")}})(e.id),className:"text-red-600 hover:text-red-900",children:"Usu\u0144"})]})]},e.id)))})]})})]})]})]}),k&&(0,P.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,P.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,P.jsxs)("div",{className:"mt-3",children:[(0,P.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:_?"Edytuj firm\u0119":"Dodaj firm\u0119"}),(0,P.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{_?await u(_.id,C):await x(C),z(!1),await U()}catch(v){console.error("Error saving company:",v),N("B\u0142\u0105d podczas zapisywania firmy")}},children:[(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nazwa firmy"}),(0,P.jsx)("input",{type:"text",value:C.name,onChange:e=>D((0,q.A)((0,q.A)({},C),{},{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,P.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,P.jsx)("button",{type:"button",onClick:()=>z(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Anuluj"}),(0,P.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:_?"Zaktualizuj":"Dodaj"})]})]})]})})}),A&&(0,P.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:(0,P.jsx)("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:(0,P.jsxs)("div",{className:"mt-3",children:[(0,P.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:R?"Edytuj u\u017cytkownika":"Dodaj u\u017cytkownika"}),(0,P.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=(0,q.A)({},B);e.company_id||(e.company_id=null),R?(e.password||delete e.password,await g(R.id,e)):await y(e),L(!1),await U()}catch(v){console.error("Error saving user:",v),N("B\u0142\u0105d podczas zapisywania u\u017cytkownika")}},children:[(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nazwa u\u017cytkownika"}),(0,P.jsx)("input",{type:"text",value:B.username,onChange:e=>I((0,q.A)((0,q.A)({},B),{},{username:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Has\u0142o ",R&&"(pozostaw puste, aby nie zmienia\u0107)"]}),(0,P.jsx)("input",{type:"password",value:B.password,onChange:e=>I((0,q.A)((0,q.A)({},B),{},{password:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!R})]}),(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Typ u\u017cytkownika"}),(0,P.jsxs)("select",{value:B.type,onChange:e=>I((0,q.A)((0,q.A)({},B),{},{type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,P.jsx)("option",{value:"owner",children:"W\u0142a\u015bciciel"}),(0,P.jsx)("option",{value:"admin",children:"Administrator"}),(0,P.jsx)("option",{value:"user",children:"U\u017cytkownik"})]})]}),(0,P.jsxs)("div",{className:"mb-4",children:[(0,P.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Firma"}),(0,P.jsxs)("select",{value:B.company_id,onChange:e=>I((0,q.A)((0,q.A)({},B),{},{company_id:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,P.jsx)("option",{value:"",children:"Brak (tylko dla w\u0142a\u015bciciela)"}),l.map((e=>(0,P.jsx)("option",{value:e.id,children:e.name},e.id)))]})]}),(0,P.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,P.jsx)("button",{type:"button",onClick:()=>L(!1),className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Anuluj"}),(0,P.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:R?"Zaktualizuj":"Dodaj"})]})]})]})})})]})},F=()=>{const[e,t]=(0,s.useState)(null),[a,r]=(0,s.useState)(!0);(0,s.useEffect)((()=>{n()}),[]);const n=async()=>{if(localStorage.getItem("token"))try{const e=localStorage.getItem("user");e?t(JSON.parse(e)):localStorage.removeItem("token")}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("token")}r(!1)},l=(e,a)=>{localStorage.setItem("token",a),localStorage.setItem("user",JSON.stringify(e)),t(e)},i=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t(null)};return a?(0,P.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,P.jsx)("div",{className:"text-xl",children:"\u0141adowanie..."})}):e?"owner"===e.type?(0,P.jsx)(T,{user:e,onLogout:i}):(0,P.jsx)("div",{className:"min-h-screen bg-gray-100",children:"admin"===e.role?(0,P.jsx)(Q,{user:e,onLogout:i}):(0,P.jsx)(U,{user:e,onLogout:i})}):(0,P.jsx)(E,{onLogin:l})}}}]);
//# sourceMappingURL=45.64852e66.chunk.js.map